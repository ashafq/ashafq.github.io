
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="robots" content="" />

  <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:ital,wght@0,400;0,700;1,400&family=Source+Sans+Pro:ital,wght@0,300;0,400;0,700;1,400&display=swap" rel="stylesheet">

    <link rel="stylesheet" type="text/css" href="./theme/stylesheet/style.min.css">


    <link id="pygments-light-theme" rel="stylesheet" type="text/css"
          href="./theme/pygments/lovelace.min.css">



  <link rel="stylesheet" type="text/css" href="./theme/font-awesome/css/fontawesome.css">
  <link rel="stylesheet" type="text/css" href="./theme/font-awesome/css/brands.css">
  <link rel="stylesheet" type="text/css" href="./theme/font-awesome/css/solid.css">


  <link rel="shortcut icon" href="/images/favicon.ico" type="image/x-icon">
  <link rel="icon" href="/images/favicon.ico" type="image/x-icon">

  <!-- Chrome, Firefox OS and Opera -->
  <meta name="theme-color" content="#333333">
  <!-- Windows Phone -->
  <meta name="msapplication-navbutton-color" content="#333333">
  <!-- iOS Safari -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <!-- Microsoft EDGE -->
  <meta name="msapplication-TileColor" content="#333333">

  <link href="https://shafq.at/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Ayan Shafqat Atom">









<meta name="author" content="Ayan Shafqat" />
<meta name="description" content="An easy-sounding “Float to Q1.15” challenge is proposed as an audio FizzBuzz interview question." />
<meta name="keywords" content="fizzbuzz, interview, tech, C, C++">


  <meta property="og:site_name" content="Ayan Shafqat"/>
  <meta property="og:title" content="Float to Q1.15: A FizzBuzz for Audio Technical Interview"/>
  <meta property="og:description" content="An easy-sounding “Float to Q1.15” challenge is proposed as an audio FizzBuzz interview question."/>
  <meta property="og:locale" content="en_US"/>
  <meta property="og:url" content="./fizzbuzz-for-audio.html"/>
  <meta property="og:type" content="article"/>
  <meta property="article:published_time" content="2025-01-19 00:00:00-05:00"/>
  <meta property="article:modified_time" content="2025-01-19 00:00:00-05:00"/>
  <meta property="article:author" content="./author/ayan-shafqat.html">
  <meta property="article:section" content="Programming"/>
  <meta property="article:tag" content="fizzbuzz"/>
  <meta property="article:tag" content="interview"/>
  <meta property="article:tag" content="tech"/>
  <meta property="article:tag" content="C"/>
  <meta property="article:tag" content="C++"/>
  <meta property="og:image" content="/images/profile.png">

  <title>Ayan Shafqat &ndash; Float to Q1.15: A FizzBuzz for Audio Technical Interview</title>


</head>
<body class="light-theme">

<aside>
  <div>
    <a href="./">
      <img src="/images/profile.png" alt="Ayan Shafqat" title="Ayan Shafqat">
    </a>

    <h1>
      <a href="./">Ayan Shafqat</a>
    </h1>

    <p>My personal website</p>


    <nav>
      <ul class="list">


            <li>
              <a target="_self"
                 href="./pages/about.html#about">
                About
              </a>
            </li>
            <li>
              <a target="_self"
                 href="./pages/papers.html#papers">
                Papers
              </a>
            </li>

      </ul>
    </nav>

    <ul class="social">
      <li>
        <a class="sc-envelope"
rel="me"           href="mailto:ayan.x.shafqat@gmail.com"
           target="_blank">
          <i class="fa-solid fa-envelope"></i>
        </a>
      </li>
      <li>
        <a class="sc-github"
           href="https://github.com/ashafq"
           target="_blank">
          <i class="fa-brands fa-github"></i>
        </a>
      </li>
      <li>
        <a class="sc-stack-overflow"
           href="http://stackoverflow.com/users/6744189/ayan-shafqat"
           target="_blank">
          <i class="fa-brands fa-stack-overflow"></i>
        </a>
      </li>
      <li>
        <a class="sc-linkedin"
           href="https://www.linkedin.com/in/ayanshafqat"
           target="_blank">
          <i class="fa-brands fa-linkedin"></i>
        </a>
      </li>
      <li>
        <a class="sc-rss"
           href="https://shafq.at/feeds/all.atom.xml"
           target="_blank">
          <i class="fa-solid fa-rss"></i>
        </a>
      </li>
    </ul>
  </div>

</aside>
  <main>

<nav>
  <a href="./">Home</a>

  <a href="/archives.html">Archives</a>
  <a href="/categories.html">Categories</a>
  <a href="/tags.html">Tags</a>

  <a href="https://shafq.at/feeds/all.atom.xml">Atom</a>

</nav>

<article class="single">
  <header>
      
    <h1 id="fizzbuzz-for-audio">Float to Q1.15: A FizzBuzz for Audio Technical Interview</h1>
    <p>
      Posted on Sun 19 January 2025 in <a href="./category/programming.html">Programming</a>

    </p>
  </header>


  <div>
    <p>I don’t enjoy watching candidates squirm through tricky interviews any more
than anyone else does. Let’s face it: a job interview is stressful enough! Being
judged on every syllable over a video call (or in a room) isn’t exactly fun.
And if I’m the interviewer, I’m also under pressure to complete my own work on
top of conducting the interview.</p>
<p>It’s counterproductive to throw overly difficult questions at candidates just
to see them fail. Instead, I like straightforward “benchmark” questions—much
like <a href="https://en.wikipedia.org/wiki/Fizz_buzz">FizzBuzz</a>. FizzBuzz is trivial
to solve in under five minutes, but it still offers a ton of room for
improvement and optimization. Don’t believe me? Check out the <a href="https://codegolf.stackexchange.com/questions/215216/high-throughput-fizz-buzz/">High throughput
FizzBuzz</a>
code golf page, where some solutions run nearly as fast as
<a href="https://www.man7.org/linux/man-pages/man3/memcpy.3.html"><code>memcpy(3)</code></a>!</p>
<p>I wanted a similar litmus test for hiring audio programming candidates, and I
think I may have found it. Let’s dive into the “Float to Q1.16” challenge: The
<em>FizzBuzz</em> of audio programming:</p>
<p><strong>Task:</strong> Convert an array of 32-bit floating-point audio samples into 16-bit
fixed-point format (<code>Q1.15</code>). Specifically:</p>
<ol>
<li><strong>Input Range:</strong> Any valid <code>float32</code> value (i.e., the entire representable
   range of single-precision floats).</li>
<li><strong>Output Range:</strong> Scale, round, and clamp so that <code>[-1.0, +1.0)</code> in
   floating-point maps to <code>[-32768, +32767)</code> in <code>int16_t</code>. Any values below
   <code>-1.0</code> should clamp to <code>-32768</code>, and any values above <code>+1.0</code> should clamp to
   <code>+32767</code>.</li>
</ol>
<p>A suitable function prototype might be:</p>
<div class="highlight"><pre><span></span><code><span class="kt">void</span><span class="w"> </span><span class="nf">float_to_q1x15</span><span class="p">(</span><span class="kt">int16_t</span><span class="w"> </span><span class="o">*</span><span class="n">dst</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">src</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">samples</span><span class="p">);</span>
</code></pre></div>

<p>Here, I will also give a possible answer as well:</p>
<div class="highlight"><pre><span></span><code><span class="kt">void</span><span class="w"> </span><span class="nf">float_to_q1x15</span><span class="p">(</span><span class="kt">int16_t</span><span class="w"> </span><span class="o">*</span><span class="n">dst</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">src</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">len</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">len</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">src</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mh">0x1</span><span class="p">.</span><span class="n">p15F</span><span class="p">;</span><span class="w"> </span><span class="cm">/* Scale by 2**15 */</span>

<span class="w">    </span><span class="cm">/* Clamp */</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">INT16_MAX</span><span class="p">)</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">INT16_MAX</span><span class="p">;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">INT16_MIN</span><span class="p">)</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">INT16_MIN</span><span class="p">;</span>

<span class="w">    </span><span class="n">dst</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">int16_t</span><span class="p">)</span><span class="n">x</span><span class="p">;</span><span class="w"> </span><span class="cm">/* Convert to int16_t */</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>Easy, right?</strong> But this is just the start. FizzBuzz is also easy—until it’s
not. Let’s expand on the requirements:</p>
<ul>
<li>What if the input is 0.5? What output do we get?</li>
<li>What if the input is 0.50001 or 0.49995? How do we handle rounding?</li>
<li>Are we applying simple truncation, or do we need a specific rounding method
  (e.g., round half up, round half to even, or
  <a href="https://en.wikipedia.org/wiki/Dither">dither</a>)?</li>
</ul>
<p>Now we’re dipping our toes into DSP theory and the quirks of floating-point
arithmetic. Floats are straightforward to use in code but notoriously tricky to
get fully “correct.” It’s not uncommon to encounter a mysterious <code>NaN</code> that
sneaks into your audio pipeline because of a filter that’s been pushed just a
bit too far. From my experience as an audio software engineer, I can tell you
that <code>NaNs</code> are like nuclear bombs for an audio pipeline, and no amount of
<code>-ffast-math</code> will save you from the fallout.</p>
<p><strong>Questions to consider next:</strong></p>
<ul>
<li>Given <code>[-1, +1)</code> as your input range, how many bits of precision do you truly
  have in <code>float32</code> representation?</li>
<li>Should you always round your scaled output, or is truncation acceptable?</li>
<li>If rounding, which method is best for audio signals?</li>
</ul>
<p>By exploring these nuances, you can quickly spot which candidates have hands-on
DSP experience—and which ones haven’t battled those late-night <code>NaN</code> bugs
(yet). This is exactly why I like to call this “the FizzBuzz of audio
programming.” It starts simple but reveals deeper topics lurking just below the
surface. Plus, I think it's a fun way to continue a conversation!</p>
  </div>
  <div class="tag-cloud">
    <p>
      <a href="./tag/fizzbuzz.html">fizzbuzz</a>
      <a href="./tag/interview.html">interview</a>
      <a href="./tag/tech.html">tech</a>
      <a href="./tag/c.html">C</a>
      <a href="./tag/c.html">C++</a>
    </p>
  </div>






</article>

<footer>
  <p>All opinions expressed on this site are solely my own and do not necessarily reflect the views or opinions of my current or former employers.</p>

<p>
  &copy; 2017-2025 Ayan Shafqat  - This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/deed.en_US" target="_blank">Creative Commons Attribution-ShareAlike</a>
</p>
<p>
Built with <a href="http://getpelican.com" target="_blank">Pelican</a> using <a href="http://bit.ly/flex-pelican" target="_blank">Flex</a> theme
</p><p>
  <a rel="license"
     href="http://creativecommons.org/licenses/by-sa/4.0/"
     target="_blank">
    <img alt="Creative Commons License"
         title="Creative Commons License"
         style="border-width:0"
           src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png"
         width="80"
         height="15"/>
  </a>
</p></footer>  </main>

<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " Ayan Shafqat ",
  "url" : ".",
  "image": "/images/profile.png",
  "description": "Personal website of Ayan Shafqat"
}
</script>
</body>
</html>